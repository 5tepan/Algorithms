{
1. 14.6. ??????????? (8)
? ???????? ????????? M ???????????? ?? N ??????????????. ?? ?????? ????????????? ???????? ????? ????????? ???? ??? ?????????? ????????????. ?????? ?????????? ????? ????? ??????????? ? ???????? ??? ?? ?????, ??? ? ?? ?????????? ?????????????? ?? ???? N ????????????.
 ???  ??????? ? ???????? ?? ????????????? ?????????? ?????? ????? ?????????? ????. ????? ?? ?????? ????????????? ????? ???? ????????. ?????? ?????, ?????????? ??? ?????? ????????? ????????????? ????????? ?????????, ?????????? ????? ??????, ??????? ? 1 (?????? ?????????).
 ?????? ???????? ???????? ????????? ??????????? ?? ????????????? ? ??????????? ??????? ??? ???? ???????????. ????????, ??? ?? ?????? ????????????? ????? ??????????? ?? ??? ???????????? ????????? ??????????.
??????? ????????? ??????? ??????:
?????????? ????????????, ??????????? ?? ?????? ?????????????, ?? ??????????? ????? ????????? ????;
???? ?????????? ???????? ? ????? ????????? ???? ? ??????? ?? ???????? ?????????? ?????? ?? ?????????? ??????????????, ?? ?? ??????????? ?? ????????????? ? ??????????? ??????? ??? ???? ???????????.
???????? ????????? ??? ?????????? ????????????.
???? ?? ????? INPUT.TXT. ??????????? ? ????????????? ????????????? ?? 1 ?? M ? ?? 1 ?? N ??????????????. ? ?????? ?????? ???????? ????? ?????? M ? N - ????? ???????????? ? ?????????????? ??????????????. ?? ?????? ?????? ???????? ????? ?????? N ????? ????? Li, ??????????????? ??????????? ????????? ???? ? ??????? ??????????? ??????? ??????????????. ? ????????? M ?????? - ?????? ?? ????????????. ? ?????? ?????? i-?? ????? ???????? Ki - ????? ?????????????? i-?? ???????????. ? ????????? Ki ??????? - ????? ????????????? ? ?????????? ???? i-?? ??????????? Si j ?? ?????? ????????????? ? ??????? ????????????????? ?????????? ?????? ??????????.
???????????: 1 = M = 1000; 1 = N = 10; 1 = Li , Sij = 100; 1 = Ki = N.
????? ? ???? OUTPUT.TXT. ?????????? ? ??????????? ???????? N ?????. ? i-? ?????? ????????? ????? ?????? ?????? ??????????? ?? i-? ????????????? ???????????? ?? ???????? ????????? ??????. ???? ?????? ?? ????????? ????????????? ?? ?????????, ? ??????????????? ?????? ????????? ????? No. 
???????
???? 1       ???? 2
5 2          4 2
2 2          2 2
2            2 
1 90         1 90 
2 85         2 80
2            2
2 50         2 85
1 70         1 70
1            1 
1 60         1 60
1            1 
2 80         2 75
1                
2 70             
????? 1      ????? 2
1 2          1 3
4 5          2 4
2.Фомин Степан ПС-21
3. Dev+GNU Pascal 1.9.4.13
   Кодировка - 1251
4.INPUT - test.txt
  OUTPUT - testout1.txt
5.INPUT - 
  OUTPUT - отредактированяй текст в файле


}




Program Lab1(Input, Output);
Var
  Fin,Fout: Text;
  NameFile: STRING;
  Ch: CHAR; 
  Prof: array [1..10,1..10] of INTEGER ;              //количество мест , кол-во поступивших
  AbiturBall: array [1..1000,1..10,1..3] of INTEGER ;//[студент,номер специальности]=приоритет,балл, поступление
  ListStud: array [1..10,1..1000] of INTEGER ;
  N,M,b,i,j,KolSpec,ii,jj,KolMest,Stud,NomProf,MaxKolSpec,Prior: INTEGER;
  Nstr: STRING;
  Flag: BOOLEAN;
PROCEDURE Sort();
VAR i,j,Stud: INTEGER;
BEGIN
  FOR i:=1 to N 
   DO
     FOR j:=1 to M-1 
     DO
       FOR jj:=j+1 to M 
       DO
         IF (AbiturBall[ListStud[i,j],i,2]< AbiturBall[ListStud[i,jj],i,2])
         THEN
           BEGIN
             Stud:=ListStud[i,jj];
             ListStud[i,jj]:=ListStud[i,j];
             ListStud[i,j]:=Stud;
           END;
END;
PROCEDURE Print();                                                              
VAR i,j: INTEGER;
BEGIN
  FOR i:=1 to N 
  DO
    BEGIN
      FOR j:=1 to Prof[i,1]
      DO  
        IF  (ListStud[i,j]>0) AND (AbiturBall[ListStud[i,j],i,3]=1)
        THEN
          WRITE(FOUT,ListStud[i,j]," ");   
      WRITELN(FOUT);  
    END;  
END;
PROCEDURE PrintList();                                                              
VAR i,j: INTEGER;
BEGIN
  FOR i:=1 to N 
  DO
    BEGIN
      WRITELN(FOUT,"Спец: ",i);
      FOR j:=1 to M
      DO  
        IF ListStud[i,j]>0
        THEN
          WRITELN(FOUT," кандидат= ",ListStud[i,j]," с баллами ",AbiturBall[ListStud[i,j],i,2],"( ",AbiturBall[ListStud[i,j],i,1],", поступил=",AbiturBall[ListStud[i,j],i,3],") ");
      WRITELN(FOUT);  
    END;  
END;

PROCEDURE SetListStudent(PriorS,PriorE: INTEGER);
VAR i,j,ii,Kol,Prior: INTEGER;
 BEGIN
 FOR Prior:=PriorS to PriorE
 DO
 BEGIN 
   Sort();
   PrintList();
   FOR i:=1 to N 
    DO
      BEGIN
        Kol:=0;                    
        FOR j:=1 to M
        DO
          BEGIN
            IF(AbiturBall[ListStud[i,j],i,2]<>0) AND (AbiturBall[ListStud[i,j],i,3]=0) AND (AbiturBall[ListStud[i,j],i,1]>Prior)// кандидаты следующих волн
            THEN
              Kol:=Kol+1;
            IF(AbiturBall[ListStud[i,j],i,2]<>0) AND (AbiturBall[ListStud[i,j],i,3]=0) AND (AbiturBall[ListStud[i,j],i,1]<=Prior) AND (Prof[i,1]>(Prof[i,2]+Kol)) //поступил
            THEN
            BEGIN
              Prof[i,2]:=Prof[i,2]+1;
              AbiturBall[ListStud[i,j],i,3]:=1; 
              WRITELN(FOUT,"Приоритет ",Prior,". ",ListStud[i,j], " поступил "," на ",i," c баллами ", AbiturBall[ListStud[i,j],i,2]);
              Flag:=FALSE;
              FOR ii:=1 to N
              DO
                IF  (ii<>i) AND (AbiturBall[ListStud[i,j],ii,2]>0) AND   (AbiturBall[ListStud[i,j],ii,1]>AbiturBall[ListStud[i,j],i,1])
                THEN
                  BEGIN
                    WRITELN(FOUT," убираем ",ListStud[i,j]," из кандидатов в поступление по факультетe ",ii," c приоритетом ", AbiturBall[ListStud[i,j],ii,1]," c баллами ", AbiturBall[ListStud[i,j],ii,2]);                    
                    AbiturBall[ListStud[i,j],ii,2]:=0;
                    IF AbiturBall[ListStud[i,j],ii,3]=1   // было поступление с другим приоритетом - синмаем метку, уменьшанм ко-во поступивших
                    THEN
                      BEGIN
                        AbiturBall[ListStud[i,j],ii,3]:=0;
                        Prof[ii,2]:=Prof[ii,2]-1;
                      END;
                    Flag:=TRUE;
                  END; 
                IF (Flag)
                THEN
                  SetListStudent(1,Prior);

          END;                
      END;
    END;
 END;
 END;
 
 BEGIN
 ASSIGN(Fin, 'input.txt');
  RESET(Fin);
  ASSIGN(FOut, 'output.txt');
  REWRITE(FOut);
  //1  кол-во студ, специал
  READLN(Fin,Nstr);
  i:=Pos(' ',Nstr);  
  VAL(Copy(Nstr,1,i-1),M,b);
  VAL(Copy(Nstr,i+1,Length(Nstr)),N,b);
  //2 вак.места
  j:=1;
  Nstr:="";
  WHILE NOT EOLN(Fin)
  DO
    BEGIN
      READ(Fin,CH); 
      IF  CH=' '
      THEN
        BEGIN
          VAL(Nstr,Prof[j,1],b);
          j:=j+1;
          Nstr:="";
        END
      ELSE
        Nstr:=Nstr+CH;
    END;  
  VAL(Nstr,Prof[j,1],b);            
  READLN(Fin);   
  //блоки студентов
  i:=1;
  KolSpec:=0;
  MaxKolSpec:=0;
  WHILE NOT EOF(Fin)
  DO
    BEGIN
      IF KolSpec=0
      THEN
        BEGIN
          READLN(Fin,Nstr); 
          VAL(Nstr,KolSpec,b);
        END;  
      IF MaxKolSpec< KolSpec
      THEN
        MaxKolSpec:=KolSpec;
      FOR j:=1 TO KolSpec
      DO
        BEGIN  
          READLN(Fin,Nstr);
          ii:=Pos(' ',Nstr);
          Prior:=0;
          VAL(Copy(Nstr,1,ii-1),Prior,b);
          AbiturBall[i,Prior,1]:=j;
          VAL(Copy(Nstr,ii+1,Length(Nstr)),AbiturBall[i,Prior,2],b);
          ListStud[Prior,i]:=i;
        END;
      KolSpec:=0; 
      i:=i+1; 
    END;
  FOR i:=1 to MaxKolSpec     
  DO 
    SetListStudent(i,i);
 Sort();       
 Print();
    
END.    
